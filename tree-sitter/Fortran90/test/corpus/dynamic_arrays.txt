================================================================================
Fortran 90 allocatable arrays
================================================================================

program dynamic_memory
    implicit none
    integer :: n, i
    real, allocatable, dimension(:) :: x
    real, allocatable, dimension(:,:) :: matrix
    
    ! Get array size from user
    write(*,*) 'Enter array size:'
    read(*,*) n
    
    ! Allocate arrays
    allocate(x(n))
    allocate(matrix(n, n))
    
    ! Check allocation status
    if (.not. allocated(x)) then
        stop 'Allocation failed for x'
    end if
    
    ! Initialize arrays
    x = [(real(i), i = 1, n)]
    matrix = 0.0
    
    ! Set diagonal elements
    do i = 1, n
        matrix(i, i) = x(i)
    end do
    
    ! Deallocate memory
    deallocate(x, matrix)
    
end program dynamic_memory

--------------------------------------------------------------------------------

(program
  (program_unit
    (main_program
      (program_stmt
        (program_name))
      (specification_part
        (implicit_part
          (implicit_stmt))
        (declaration_construct
          (type_declaration_stmt
            (declaration_type_spec
              (intrinsic_type_spec))
            (entity_decl_list
              (entity_decl
                (object_name))
              (entity_decl
                (object_name)))))
        (declaration_construct
          (type_declaration_stmt
            (declaration_type_spec
              (intrinsic_type_spec))
            (attr_spec_list
              (attr_spec)
              (attr_spec
                (array_spec
                  (deferred_shape_spec_list
                    (deferred_shape_spec)))))
            (entity_decl_list
              (entity_decl
                (object_name)))))
        (declaration_construct
          (type_declaration_stmt
            (declaration_type_spec
              (intrinsic_type_spec))
            (attr_spec_list
              (attr_spec)
              (attr_spec
                (array_spec
                  (deferred_shape_spec_list
                    (deferred_shape_spec)
                    (deferred_shape_spec)))))
            (entity_decl_list
              (entity_decl
                (object_name))))))
      (execution_part
        (executable_construct
          (action_stmt
            (write_stmt
              (io_control_spec_list
                (io_control_spec
                  (io_unit
                    (default_char_expr
                      (level_2_char_expr
                        (level_1_char_expr
                          (char_operand
                            (char_primary
                              (primary
                                (designator
                                  (data_ref
                                    (part_ref
                                      (part_name))))))))))))
                (io_control_spec
                  (format
                    (default_char_expr
                      (level_2_char_expr
                        (level_1_char_expr
                          (char_operand
                            (char_primary
                              (primary
                                (designator
                                  (data_ref
                                    (part_ref
                                      (part_name))))))))))))
              (output_item_list
                (output_item
                  (expr
                    (level_2_expr
                      (level_1_expr
                        (mult_operand
                          (add_operand
                            (primary
                              (char_literal_constant))))))))))))
        (executable_construct
          (action_stmt
            (read_stmt
              (io_control_spec_list
                (io_control_spec
                  (io_unit
                    (default_char_expr
                      (level_2_char_expr
                        (level_1_char_expr
                          (char_operand
                            (char_primary
                              (primary
                                (designator
                                  (data_ref
                                    (part_ref
                                      (part_name))))))))))))
                (io_control_spec
                  (format
                    (default_char_expr
                      (level_2_char_expr
                        (level_1_char_expr
                          (char_operand
                            (char_primary
                              (primary
                                (designator
                                  (data_ref
                                    (part_ref
                                      (part_name))))))))))))
              (input_item_list
                (input_item
                  (variable
                    (designator
                      (data_ref
                        (part_ref
                          (part_name))))))))))
        (executable_construct
          (action_stmt
            (allocate_stmt
              (allocation_list
                (allocation
                  (allocate_object
                    (variable_name))
                  (allocate_shape_spec_list
                    (allocate_shape_spec
                      (upper_bound_expr
                        (int_expr
                          (level_2_expr
                            (level_1_expr
                              (mult_operand
                                (add_operand
                                  (primary
                                    (designator
                                      (data_ref
                                        (part_ref
                                          (part_name)))))))))))))))
        (executable_construct
          (action_stmt
            (allocate_stmt
              (allocation_list
                (allocation
                  (allocate_object
                    (variable_name))
                  (allocate_shape_spec_list
                    (allocate_shape_spec
                      (upper_bound_expr
                        (int_expr
                          (level_2_expr
                            (level_1_expr
                              (mult_operand
                                (add_operand
                                  (primary
                                    (designator
                                      (data_ref
                                        (part_ref
                                          (part_name))))))))))))
                    (allocate_shape_spec
                      (upper_bound_expr
                        (int_expr
                          (level_2_expr
                            (level_1_expr
                              (mult_operand
                                (add_operand
                                  (primary
                                    (designator
                                      (data_ref
                                        (part_ref
                                          (part_name)))))))))))))))
        (executable_construct
          (if_construct
            (if_then_stmt
              (logical_expr
                (level_2_expr
                  (not_op
                    (level_2_expr
                      (level_1_expr
                        (mult_operand
                          (add_operand
                            (primary
                              (procedure_designator
                                (procedure_name))
                              (actual_arg_spec_list
                                (actual_arg_spec
                                  (actual_arg
                                    (expr
                                      (level_2_expr
                                        (level_1_expr
                                          (mult_operand
                                            (add_operand
                                              (primary
                                                (designator
                                                  (data_ref
                                                    (part_ref
                                                      (part_name)))))))))))))))))))))
            (execution_part_construct
              (executable_construct
                (action_stmt
                  (stop_stmt
                    (stop_code
                      (char_literal_constant))))))
            (end_if_stmt)))
        (executable_construct
          (action_stmt
            (assignment_stmt
              (variable
                (designator
                  (data_ref
                    (part_ref
                      (part_name)))))
              (expr
                (level_2_expr
                  (level_1_expr
                    (mult_operand
                      (add_operand
                        (primary
                          (array_constructor
                            (ac_spec
                              (ac_value_list
                                (ac_value
                                  (expr
                                    (level_2_expr
                                      (level_1_expr
                                        (mult_operand
                                          (add_operand
                                            (primary
                                              (procedure_designator
                                                (procedure_name))
                                              (actual_arg_spec_list
                                                (actual_arg_spec
                                                  (actual_arg
                                                    (expr
                                                      (level_2_expr
                                                        (level_1_expr
                                                          (mult_operand
                                                            (add_operand
                                                              (primary
                                                                (designator
                                                                  (data_ref
                                                                    (part_ref
                                                                      (part_name)))))))))))))))))
                                  (ac_implied_do_control
                                    (ac_do_variable)
                                    (int_expr
                                      (level_2_expr
                                        (level_1_expr
                                          (mult_operand
                                            (add_operand
                                              (primary
                                                (constant
                                                  (int_literal_constant))))))))
                                    (int_expr
                                      (level_2_expr
                                        (level_1_expr
                                          (mult_operand
                                            (add_operand
                                              (primary
                                                (designator
                                                  (data_ref
                                                    (part_ref
                                                      (part_name))))))))))))))))))))
        (executable_construct
          (action_stmt
            (assignment_stmt
              (variable
                (designator
                  (data_ref
                    (part_ref
                      (part_name)))))
              (expr
                (level_2_expr
                  (level_1_expr
                    (mult_operand
                      (add_operand
                        (primary
                          (constant
                            (real_literal_constant)))))))))))
        (executable_construct
          (do_construct
            (nonlabel_do_stmt
              (loop_control
                (do_variable)
                (int_expr
                  (level_2_expr
                    (level_1_expr
                      (mult_operand
                        (add_operand
                          (primary
                            (constant
                              (int_literal_constant))))))))
                (int_expr
                  (level_2_expr
                    (level_1_expr
                      (mult_operand
                        (add_operand
                          (primary
                            (designator
                              (data_ref
                                (part_ref
                                  (part_name))))))))))))
            (execution_part_construct
              (executable_construct
                (action_stmt
                  (assignment_stmt
                    (variable
                      (designator
                        (data_ref
                          (part_ref
                            (part_name)
                            (section_subscript_list
                              (section_subscript
                                (subscript_triplet
                                  (subscript
                                    (int_expr
                                      (level_2_expr
                                        (level_1_expr
                                          (mult_operand
                                            (add_operand
                                              (primary
                                                (designator
                                                  (data_ref
                                                    (part_ref
                                                      (part_name)))))))))))
                              (section_subscript
                                (subscript_triplet
                                  (subscript
                                    (int_expr
                                      (level_2_expr
                                        (level_1_expr
                                          (mult_operand
                                            (add_operand
                                              (primary
                                                (designator
                                                  (data_ref
                                                    (part_ref
                                                      (part_name))))))))))))))))
                    (expr
                      (level_2_expr
                        (level_1_expr
                          (mult_operand
                            (add_operand
                              (primary
                                (designator
                                  (data_ref
                                    (part_ref
                                      (part_name)
                                      (section_subscript_list
                                        (section_subscript
                                          (subscript_triplet
                                            (subscript
                                              (int_expr
                                                (level_2_expr
                                                  (level_1_expr
                                                    (mult_operand
                                                      (add_operand
                                                        (primary
                                                          (designator
                                                            (data_ref
                                                              (part_ref
                                                                (part_name)))))))))))))))))))))))))
            (end_do_stmt)))
        (executable_construct
          (action_stmt
            (deallocate_stmt
              (allocate_object_list
                (allocate_object
                  (variable_name))
                (allocate_object
                  (variable_name)))))))
      (end_program_stmt
        (program_name)))))