================================================================================
Fortran 90 free form source
================================================================================

program free_form_demo
    implicit none
    integer, parameter :: n = 10
    real, dimension(n) :: array
    integer :: i
    
    ! Initialize array using array constructor
    array = [(real(i), i = 1, n)]
    
    ! Use WHERE construct
    where (array > 5.0)
        array = array * 2.0
    elsewhere
        array = 0.0
    end where
    
    ! Print results
    do i = 1, n
        write(*,'(I0,": ",F6.2)') i, array(i)
    end do
    
end program free_form_demo

--------------------------------------------------------------------------------

(program
  (program_unit
    (main_program
      (program_stmt
        (program_name))
      (specification_part
        (implicit_part
          (implicit_stmt))
        (declaration_construct
          (type_declaration_stmt
            (declaration_type_spec
              (intrinsic_type_spec))
            (attr_spec_list
              (attr_spec))
            (entity_decl_list
              (entity_decl
                (object_name)
                (initialization
                  (constant_expr
                    (level_2_expr
                      (level_1_expr
                        (mult_operand
                          (add_operand
                            (primary
                              (constant
                                (int_literal_constant)))))))))))))
        (declaration_construct
          (type_declaration_stmt
            (declaration_type_spec
              (intrinsic_type_spec))
            (attr_spec_list
              (attr_spec
                (array_spec
                  (explicit_shape_spec_list
                    (explicit_shape_spec
                      (upper_bound
                        (specification_expr
                          (level_2_expr
                            (level_1_expr
                              (mult_operand
                                (add_operand
                                  (primary
                                    (designator
                                      (data_ref
                                        (part_ref
                                          (part_name))))))))))))))
            (entity_decl_list
              (entity_decl
                (object_name)))))
        (declaration_construct
          (type_declaration_stmt
            (declaration_type_spec
              (intrinsic_type_spec))
            (entity_decl_list
              (entity_decl
                (object_name))))))
      (execution_part
        (executable_construct
          (action_stmt
            (assignment_stmt
              (variable
                (designator
                  (data_ref
                    (part_ref
                      (part_name)))))
              (expr
                (level_2_expr
                  (level_1_expr
                    (mult_operand
                      (add_operand
                        (primary
                          (array_constructor
                            (ac_spec
                              (ac_value_list
                                (ac_value
                                  (expr
                                    (level_2_expr
                                      (level_1_expr
                                        (mult_operand
                                          (add_operand
                                            (primary
                                              (procedure_designator
                                                (procedure_name))
                                              (actual_arg_spec_list
                                                (actual_arg_spec
                                                  (actual_arg
                                                    (expr
                                                      (level_2_expr
                                                        (level_1_expr
                                                          (mult_operand
                                                            (add_operand
                                                              (primary
                                                                (designator
                                                                  (data_ref
                                                                    (part_ref
                                                                      (part_name)))))))))))))))))
                                  (ac_implied_do_control
                                    (ac_do_variable)
                                    (int_expr
                                      (level_2_expr
                                        (level_1_expr
                                          (mult_operand
                                            (add_operand
                                              (primary
                                                (constant
                                                  (int_literal_constant))))))))
                                    (int_expr
                                      (level_2_expr
                                        (level_1_expr
                                          (mult_operand
                                            (add_operand
                                              (primary
                                                (designator
                                                  (data_ref
                                                    (part_ref
                                                      (part_name))))))))))))))))))))
        (executable_construct
          (where_construct
            (where_construct_stmt
              (logical_expr
                (level_2_expr
                  (level_1_expr
                    (rel_op
                      (level_1_expr
                        (mult_operand
                          (add_operand
                            (primary
                              (designator
                                (data_ref
                                  (part_ref
                                    (part_name))))))))
                      (level_1_expr
                        (mult_operand
                          (add_operand
                            (primary
                              (constant
                                (real_literal_constant)))))))))))
            (where_body_construct
              (action_stmt
                (assignment_stmt
                  (variable
                    (designator
                      (data_ref
                        (part_ref
                          (part_name)))))
                  (expr
                    (level_2_expr
                      (level_1_expr
                        (mult_operand
                          (add_operand
                            (primary
                              (designator
                                (data_ref
                                  (part_ref
                                    (part_name)))))))
                        (mult_operand
                          (add_operand
                            (primary
                              (constant
                                (real_literal_constant)))))))))))
            (elsewhere_stmt)
            (where_body_construct
              (action_stmt
                (assignment_stmt
                  (variable
                    (designator
                      (data_ref
                        (part_ref
                          (part_name)))))
                  (expr
                    (level_2_expr
                      (level_1_expr
                        (mult_operand
                          (add_operand
                            (primary
                              (constant
                                (real_literal_constant)))))))))))
            (end_where_stmt)))
        (executable_construct
          (do_construct
            (nonlabel_do_stmt
              (loop_control
                (do_variable)
                (int_expr
                  (level_2_expr
                    (level_1_expr
                      (mult_operand
                        (add_operand
                          (primary
                            (constant
                              (int_literal_constant))))))))
                (int_expr
                  (level_2_expr
                    (level_1_expr
                      (mult_operand
                        (add_operand
                          (primary
                            (designator
                              (data_ref
                                (part_ref
                                  (part_name))))))))))))
            (execution_part_construct
              (executable_construct
                (action_stmt
                  (write_stmt
                    (io_control_spec_list
                      (io_control_spec
                        (io_unit
                          (default_char_expr
                            (level_2_char_expr
                              (level_1_char_expr
                                (char_operand
                                  (char_primary
                                    (primary
                                      (designator
                                        (data_ref
                                          (part_ref
                                            (part_name))))))))))))
                      (io_control_spec
                        (format
                          (default_char_expr
                            (level_2_char_expr
                              (level_1_char_expr
                                (char_operand
                                  (char_primary
                                    (primary
                                      (char_literal_constant))))))))))
                    (output_item_list
                      (output_item
                        (expr
                          (level_2_expr
                            (level_1_expr
                              (mult_operand
                                (add_operand
                                  (primary
                                    (designator
                                      (data_ref
                                        (part_ref
                                          (part_name)))))))))))
                      (output_item
                        (expr
                          (level_2_expr
                            (level_1_expr
                              (mult_operand
                                (add_operand
                                  (primary
                                    (designator
                                      (data_ref
                                        (part_ref
                                          (part_name)
                                          (section_subscript_list
                                            (section_subscript
                                              (subscript_triplet
                                                (subscript
                                                  (int_expr
                                                    (level_2_expr
                                                      (level_1_expr
                                                        (mult_operand
                                                          (add_operand
                                                            (primary
                                                              (designator
                                                                (data_ref
                                                                  (part_ref
                                                                    (part_name)))))))))))))))))))))))))
            (end_do_stmt))))
      (end_program_stmt
        (program_name)))))